{"version":3,"sources":["../../../src/hooks/emitters/edge.js"],"names":["EventEmitter","cachedValue","cachedSubscribe","cachedUnsubscribe","EdgeEmitter","constructor","parent","child","value","emit","setParameters","cleanup","name","handleUpdate","undefined"],"mappings":";;AAEA,OAAOA,YAAP,MAAyB,QAAzB;AACA,SAASC,WAAT,EAAsBC,eAAtB,EAAuCC,iBAAvC,QAAgE,OAAhE;AAEA,eAAe,MAAMC,WAAN,SAA0BJ,YAA1B,CAAuC;AAGpDK,EAAAA,WAAW,CAACC,MAAD,EAAiBC,KAAjB,EAAgC;AACzC;;AADyC;;AAAA,0CAyB3BC,KAAD,IAAe;AAC5B,WAAKC,IAAL,CAAU,OAAV,EAAmBD,KAAnB;AACD,KA3B0C;;AAEzC,SAAKE,aAAL,CAAmBJ,MAAnB,EAA2BC,KAA3B;AACD;;AAEDG,EAAAA,aAAa,CAACJ,MAAD,EAAiBC,KAAjB,EAAgC;AAC3C,QAAI,CAACD,MAAD,IAAW,CAACC,KAAhB,EAAuB;AACrB,WAAKI,OAAL;AACA;AACD;;AACD,UAAMC,IAAI,GAAI,KAAIN,MAAO,IAAGC,KAAM,EAAlC;;AACA,QAAI,KAAKK,IAAL,KAAcA,IAAlB,EAAwB;AACtB,WAAKD,OAAL;AACD;;AACDT,IAAAA,eAAe,CAACU,IAAD,EAAO,KAAKC,YAAZ,CAAf;AACA,SAAKD,IAAL,GAAYA,IAAZ;AACD;;AAEQ,MAALJ,KAAK,GAAG;AACV,QAAI,CAAC,KAAKI,IAAV,EAAgB;AACd,aAAOE,SAAP;AACD;;AACD,WAAOb,WAAW,CAAC,KAAKW,IAAN,CAAlB;AACD;;AAMDD,EAAAA,OAAO,GAAG;AACR,SAAKF,IAAL,CAAU,SAAV;;AACA,QAAI,CAAC,KAAKG,IAAV,EAAgB;AACd;AACD;;AACDT,IAAAA,iBAAiB,CAAC,KAAKS,IAAN,EAAY,KAAKC,YAAjB,CAAjB;AACA,WAAO,KAAKD,IAAZ;AACD;;AAvCmD","sourcesContent":["// @flow\n\nimport EventEmitter from 'events';\nimport { cachedValue, cachedSubscribe, cachedUnsubscribe } from '../..';\n\nexport default class EdgeEmitter extends EventEmitter {\n  name: string | void;\n\n  constructor(parent?:string, child?:string) {\n    super();\n    this.setParameters(parent, child);\n  }\n\n  setParameters(parent?:string, child?:string) {\n    if (!parent || !child) {\n      this.cleanup();\n      return;\n    }\n    const name = `e/${parent}/${child}`;\n    if (this.name !== name) {\n      this.cleanup();\n    }\n    cachedSubscribe(name, this.handleUpdate);\n    this.name = name;\n  }\n\n  get value() {\n    if (!this.name) {\n      return undefined;\n    }\n    return cachedValue(this.name);\n  }\n\n  handleUpdate = (value:any) => {\n    this.emit('value', value);\n  }\n\n  cleanup() {\n    this.emit('cleanup');\n    if (!this.name) {\n      return;\n    }\n    cachedUnsubscribe(this.name, this.handleUpdate);\n    delete this.name;\n  }\n}\n"],"file":"edge.js"}