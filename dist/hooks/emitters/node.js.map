{"version":3,"sources":["../../../src/hooks/emitters/node.js"],"names":["EventEmitter","cachedValue","cachedSubscribe","cachedUnsubscribe","NodeEmitter","constructor","id","value","emit","setParameters","cleanup","name","handleUpdate","undefined"],"mappings":";;AAEA,OAAOA,YAAP,MAAyB,QAAzB;AACA,SAASC,WAAT,EAAsBC,eAAtB,EAAuCC,iBAAvC,QAAgE,OAAhE;AAEA,eAAe,MAAMC,WAAN,SAA0BJ,YAA1B,CAAuC;AAGpDK,EAAAA,WAAW,CAACC,EAAD,EAAa;AACtB;;AADsB;;AAAA,0CAyBRC,KAAD,IAAe;AAC5B,WAAKC,IAAL,CAAU,OAAV,EAAmBD,KAAnB;AACD,KA3BuB;;AAEtB,SAAKE,aAAL,CAAmBH,EAAnB;AACD;;AAEDG,EAAAA,aAAa,CAACH,EAAD,EAAa;AACxB,QAAI,CAACA,EAAL,EAAS;AACP,WAAKI,OAAL;AACA;AACD;;AACD,UAAMC,IAAI,GAAI,KAAIL,EAAG,EAArB;;AACA,QAAI,KAAKK,IAAL,KAAcA,IAAlB,EAAwB;AACtB,WAAKD,OAAL;AACD;;AACDR,IAAAA,eAAe,CAACS,IAAD,EAAO,KAAKC,YAAZ,CAAf;AACA,SAAKD,IAAL,GAAYA,IAAZ;AACD;;AAEQ,MAALJ,KAAK,GAAG;AACV,QAAI,CAAC,KAAKI,IAAV,EAAgB;AACd,aAAOE,SAAP;AACD;;AACD,WAAOZ,WAAW,CAAC,KAAKU,IAAN,CAAlB;AACD;;AAMDD,EAAAA,OAAO,GAAG;AACR,SAAKF,IAAL,CAAU,SAAV;;AACA,QAAI,CAAC,KAAKG,IAAV,EAAgB;AACd;AACD;;AACDR,IAAAA,iBAAiB,CAAC,KAAKQ,IAAN,EAAY,KAAKC,YAAjB,CAAjB;AACA,WAAO,KAAKD,IAAZ;AACD;;AAvCmD","sourcesContent":["// @flow\n\nimport EventEmitter from 'events';\nimport { cachedValue, cachedSubscribe, cachedUnsubscribe } from '../..';\n\nexport default class NodeEmitter extends EventEmitter {\n  name: string | void;\n\n  constructor(id?:string) {\n    super();\n    this.setParameters(id);\n  }\n\n  setParameters(id?:string) {\n    if (!id) {\n      this.cleanup();\n      return;\n    }\n    const name = `n/${id}`;\n    if (this.name !== name) {\n      this.cleanup();\n    }\n    cachedSubscribe(name, this.handleUpdate);\n    this.name = name;\n  }\n\n  get value() {\n    if (!this.name) {\n      return undefined;\n    }\n    return cachedValue(this.name);\n  }\n\n  handleUpdate = (value:any) => {\n    this.emit('value', value);\n  }\n\n  cleanup() {\n    this.emit('cleanup');\n    if (!this.name) {\n      return;\n    }\n    cachedUnsubscribe(this.name, this.handleUpdate);\n    delete this.name;\n  }\n}\n"],"file":"node.js"}